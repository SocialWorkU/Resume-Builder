<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocialWorkU AI-Enhanced Resume Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #163C77 0%, #3CBFBF 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }
        
        .ai-badge {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            backdrop-filter: blur(10px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .progress-bar {
            background: #e2e8f0;
            height: 4px;
            border-radius: 2px;
            margin-bottom: 20px;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #3CBFBF 0%, #163C77 100%);
            height: 100%;
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 25%;
        }
        
        .builder-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        .form-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            height: fit-content;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .preview-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            position: sticky;
            top: 20px;
        }
        
        .score-panel {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #3CBFBF;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #3CBFBF 0%, #2ba8a8 100%);
        }
        
        .score-excellent { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .score-good { background: linear-gradient(135deg, #3CBFBF 0%, #2ba8a8 100%); }
        .score-fair { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .score-poor { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        
        .score-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .score-item {
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #163C77;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .template-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .template-option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            text-align: center;
            position: relative;
        }
        
        .template-option.active {
            background: #163C77;
            color: white;
            border-color: #163C77;
        }
        
        .template-option.ats-optimized::after {
            content: "ATS";
            position: absolute;
            top: -5px;
            right: -5px;
            background: #10b981;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #e2e8f0;
            position: relative;
        }
        
        .section-complete {
            position: absolute;
            top: 0;
            right: 0;
            color: #10b981;
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .section-complete.visible {
            opacity: 1;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-section h3 {
            color: #163C77;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group {
            margin-bottom: 15px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .required::after {
            content: "*";
            color: #ef4444;
            margin-left: 4px;
        }
        
        .form-group input, 
        .form-group textarea, 
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .form-group input:focus, 
        .form-group textarea:focus, 
        .form-group select:focus {
            outline: none;
            border-color: #3CBFBF;
            box-shadow: 0 0 0 3px rgba(60, 191, 191, 0.1);
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
            padding-bottom: 25px;
        }
        
        .character-count {
            position: absolute;
            bottom: 8px;
            right: 10px;
            font-size: 0.75rem;
            color: #6b7280;
            background: rgba(255, 255, 255, 0.9);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .character-count.warning {
            color: #f59e0b;
        }
        
        .character-count.error {
            color: #ef4444;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .btn {
            background: #163C77;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn:hover {
            background: #0f2557;
            transform: translateY(-1px);
        }
        
        .btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #6b7280;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-ai {
            background: linear-gradient(135deg, #8b5cf6 0%, #3CBFBF 100%);
            position: relative;
            overflow: hidden;
        }
        
        .btn-ai::before {
            content: "";
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #8b5cf6, #3CBFBF, #8b5cf6);
            border-radius: inherit;
            z-index: -1;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: 200% center; }
            100% { background-position: -200% center; }
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.8rem;
        }
        
        .btn-group {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .ai-suggestions {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
            border: 1px solid #8b5cf6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            display: none;
        }
        
        .ai-suggestions.visible {
            display: block;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .ai-suggestions h4 {
            color: #8b5cf6;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .suggestion-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
        }
        
        .suggestion-item:hover {
            border-color: #8b5cf6;
            background: #faf5ff;
        }
        
        .add-item-btn {
            background: #f0f9ff;
            border: 2px dashed #3CBFBF;
            color: #3CBFBF;
            border-radius: 6px;
            padding: 15px;
            width: 100%;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .add-item-btn:hover {
            background: #3CBFBF;
            color: white;
        }
        
        .dynamic-item {
            background: #f8fafc;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
            position: relative;
        }
        
        .remove-item {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .remove-item:hover {
            background: #dc2626;
            transform: scale(1.1);
        }
        
        .help-text {
            font-size: 0.8rem;
            color: #6b7280;
            font-style: italic;
            margin-top: 4px;
        }
        
        /* Resume Preview Styles */
        .resume-preview {
            background: white;
            min-height: 600px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 40px;
            font-family: 'Times New Roman', serif;
            line-height: 1.4;
            font-size: 11pt;
            max-height: 70vh;
            overflow-y: auto;
            position: relative;
        }
        
        .ats-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #10b981;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .resume-header {
            text-align: center;
            border-bottom: 2px solid #163C77;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        
        .resume-name {
            font-size: 24pt;
            font-weight: bold;
            color: #163C77;
            margin-bottom: 5px;
        }
        
        .resume-title {
            font-size: 14pt;
            color: #666;
            margin-bottom: 8px;
        }
        
        .resume-contact {
            font-size: 10pt;
            color: #666;
            line-height: 1.2;
        }
        
        .resume-section {
            margin-bottom: 20px;
        }
        
        .resume-section-title {
            font-size: 14pt;
            font-weight: bold;
            color: #163C77;
            border-bottom: 1px solid #163C77;
            margin-bottom: 10px;
            padding-bottom: 2px;
        }
        
        .experience-item,
        .education-item {
            margin-bottom: 15px;
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
        }
        
        .item-title {
            font-weight: bold;
            color: #163C77;
        }
        
        .item-organization {
            font-style: italic;
            color: #666;
        }
        
        .item-date {
            font-size: 10pt;
            color: #666;
            white-space: nowrap;
        }
        
        .item-description {
            margin-top: 5px;
        }
        
        .item-description ul {
            margin: 5px 0 0 20px;
            padding: 0;
        }
        
        .item-description li {
            margin-bottom: 3px;
        }
        
        .control-panel {
            background: #f8fafc;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .control-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.show {
            display: block;
        }
        
        .message.success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }
        
        .message.error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }
        
        .message.info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }
        
        .message.warning {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }
        
        .autosave-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }
        
        .autosave-indicator.visible {
            opacity: 1;
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .builder-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .preview-panel {
                position: static;
                order: 2;
            }
            
            .form-panel {
                order: 1;
            }
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .template-selector {
                grid-template-columns: 1fr 1fr;
            }
            
            .control-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn-group {
                flex-direction: column;
            }
        }
        
        @media print {
            body {
                background: white;
            }
            
            .form-panel,
            .control-panel,
            .header,
            .btn,
            .score-panel,
            .progress-bar,
            .autosave-indicator {
                display: none !important;
            }
            
            .builder-layout {
                grid-template-columns: 1fr;
            }
            
            .preview-panel {
                box-shadow: none;
                border-radius: 0;
                padding: 0;
            }
            
            .resume-preview {
                font-size: 11pt;
                padding: 0;
                border: none;
                max-height: none;
                overflow: visible;
            }
            
            .ats-indicator {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="autosave-indicator" id="autosaveIndicator">Auto-saved</div>
    
    <div class="header">
        <div class="ai-badge">AI Enhanced</div>
        <h1>SocialWorkU Resume Builder</h1>
        <p>Create ATS-optimized professional resumes tailored for social work careers</p>
    </div>

    <div class="container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div id="messageContainer"></div>
        
        <div class="builder-layout">
            <!-- Form Panel -->
            <div class="form-panel">
                <h2 class="section-title">Resume Builder</h2>
                
                <!-- Template Selection -->
                <div class="form-section">
                    <h3>Choose Template</h3>
                    <div class="template-selector">
                        <div class="template-option ats-optimized active" data-template="classic">Classic</div>
                        <div class="template-option ats-optimized" data-template="modern">Modern</div>
                        <div class="template-option ats-optimized" data-template="professional">Professional</div>
                        <div class="template-option" data-template="clinical">Clinical</div>
                    </div>
                    <div class="help-text">Templates marked with "ATS" are optimized for applicant tracking systems</div>
                </div>

                <!-- Personal Information -->
                <div class="form-section" data-section="personal">
                    <h3>Personal Information</h3>
                    <div class="section-complete" id="personalComplete">✓</div>
                    
                    <div class="form-group">
                        <label for="fullName" class="required">Full Name</label>
                        <input type="text" id="fullName" placeholder="Jane Smith, LCSW" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="professionalTitle" class="required">Professional Title</label>
                        <input type="text" id="professionalTitle" placeholder="Licensed Clinical Social Worker" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email" class="required">Email Address</label>
                            <input type="email" id="email" placeholder="jane.smith@email.com" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="required">Phone Number</label>
                            <input type="tel" id="phone" placeholder="(555) 123-4567" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city" class="required">City, State</label>
                            <input type="text" id="city" placeholder="Austin, TX" required>
                        </div>
                        <div class="form-group">
                            <label for="linkedin">LinkedIn Profile</label>
                            <input type="url" id="linkedin" placeholder="linkedin.com/in/janesmith">
                        </div>
                    </div>
                </div>

                <!-- Professional Summary -->
                <div class="form-section" data-section="summary">
                    <h3>Professional Summary</h3>
                    <div class="section-complete" id="summaryComplete">✓</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-ai btn-small" onclick="generateAISummary()">✨ AI Generate</button>
                        <button class="btn btn-secondary btn-small" onclick="loadSummaryTemplate()">Load Template</button>
                        <button class="btn btn-secondary btn-small" onclick="clearField('summary')">Clear</button>
                    </div>
                    
                    <div class="ai-suggestions" id="summarySuggestions">
                        <h4>AI Suggestions</h4>
                        <div id="summaryOptions"></div>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="summary" rows="4" placeholder="Write a compelling 3-4 sentence summary highlighting your experience, specializations, and value proposition..." maxlength="500"></textarea>
                        <div class="character-count" id="summaryCount">0/500</div>
                        <div class="help-text">Focus on measurable achievements and specific social work competencies</div>
                    </div>
                </div>

                <!-- Professional Experience -->
                <div class="form-section" data-section="experience">
                    <h3>Professional Experience</h3>
                    <div class="section-complete" id="experienceComplete">✓</div>
                    
                    <div id="experienceContainer">
                        <div class="dynamic-item" data-type="experience">
                            <button class="remove-item" onclick="removeItem(this)" style="display: none;">×</button>
                            
                            <div class="btn-group" style="margin-bottom: 15px;">
                                <button class="btn btn-ai btn-small" onclick="generateJobDescription(this)">✨ AI Enhance</button>
                            </div>
                            
                            <div class="form-group">
                                <label>Job Title</label>
                                <input type="text" placeholder="Clinical Social Worker" class="job-title">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Organization</label>
                                    <input type="text" placeholder="Community Mental Health Center" class="organization">
                                </div>
                                <div class="form-group">
                                    <label>Location</label>
                                    <input type="text" placeholder="Austin, TX" class="job-location">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Start Date</label>
                                    <input type="month" class="start-date">
                                </div>
                                <div class="form-group">
                                    <label>End Date (current job: leave blank)</label>
                                    <input type="month" class="end-date">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Job Description & Achievements</label>
                                <textarea rows="4" placeholder="• Provided individual and group therapy to 25+ clients weekly&#10;• Utilized evidence-based approaches including CBT, DBT, and trauma-informed care&#10;• Achieved 95% client satisfaction rating" class="job-description" maxlength="1000"></textarea>
                                <div class="character-count">0/1000</div>
                                <div class="help-text">Use bullet points with strong action verbs and quantifiable achievements</div>
                            </div>
                        </div>
                    </div>
                    <button class="add-item-btn" onclick="addExperience()">+ Add Experience</button>
                </div>

                <!-- Education -->
                <div class="form-section" data-section="education">
                    <h3>Education</h3>
                    <div class="section-complete" id="educationComplete">✓</div>
                    
                    <div id="educationContainer">
                        <div class="dynamic-item" data-type="education">
                            <button class="remove-item" onclick="removeItem(this)" style="display: none;">×</button>
                            <div class="form-group">
                                <label>Degree</label>
                                <select class="degree">
                                    <option value="">Select Degree</option>
                                    <option value="MSW">Master of Social Work (MSW)</option>
                                    <option value="BSW">Bachelor of Social Work (BSW)</option>
                                    <option value="PhD in Social Work">PhD in Social Work</option>
                                    <option value="DSW">Doctor of Social Work (DSW)</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Institution</label>
                                    <input type="text" placeholder="University of Texas at Austin" class="institution">
                                </div>
                                <div class="form-group">
                                    <label>Graduation Year</label>
                                    <input type="number" placeholder="2020" class="grad-year" min="1950" max="2030">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Additional Details</label>
                                <textarea rows="2" placeholder="Concentration: Clinical Practice, GPA: 3.8, Magna Cum Laude" class="education-details" maxlength="300"></textarea>
                                <div class="character-count">0/300</div>
                            </div>
                        </div>
                    </div>
                    <button class="add-item-btn" onclick="addEducation()">+ Add Education</button>
                </div>

                <!-- Skills -->
                <div class="form-section" data-section="skills">
                    <h3>Skills & Competencies</h3>
                    <div class="section-complete" id="skillsComplete">✓</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-ai btn-small" onclick="generateAISkills()">✨ AI Suggest</button>
                        <button class="btn btn-secondary btn-small" onclick="loadSkillsTemplate()">Load SW Skills</button>
                        <button class="btn btn-secondary btn-small" onclick="clearSkills()">Clear All</button>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Clinical Skills</label>
                            <textarea id="clinicalSkills" rows="3" placeholder="Individual Therapy, Group Therapy, Crisis Intervention" maxlength="300"></textarea>
                            <div class="character-count">0/300</div>
                        </div>
                        <div class="form-group">
                            <label>Therapeutic Approaches</label>
                            <textarea id="therapeuticSkills" rows="3" placeholder="CBT, DBT, Trauma-Informed Care" maxlength="300"></textarea>
                            <div class="character-count">0/300</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Populations Served</label>
                            <textarea id="populationSkills" rows="3" placeholder="Adults, Children & Adolescents, Families" maxlength="300"></textarea>
                            <div class="character-count">0/300</div>
                        </div>
                        <div class="form-group">
                            <label>Technical Skills</label>
                            <textarea id="technicalSkills" rows="3" placeholder="EHR, Case Management Software, Microsoft Office" maxlength="300"></textarea>
                            <div class="character-count">0/300</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview Panel -->
            <div class="preview-panel">
                <!-- Resume Score Panel -->
                <div class="score-panel">
                    <div class="score-circle score-good" id="scoreCircle">85</div>
                    <h3>Resume Score</h3>
                    <div class="score-details" id="scoreDetails">
                        <div class="score-item">ATS: ✓ Optimized</div>
                        <div class="score-item">Keywords: Good</div>
                        <div class="score-item">Format: Excellent</div>
                        <div class="score-item">Content: Strong</div>
                    </div>
                    <button class="btn btn-ai btn-small" onclick="showDetailedAnalysis()">📊 Detailed Analysis</button>
                </div>
                
                <div class="control-panel">
                    <div class="control-row">
                        <button class="btn btn-success" onclick="downloadResume()" id="downloadBtn">📥 Download PDF</button>
                        <button class="btn btn-secondary" onclick="printResume()">🖨️ Print</button>
                        <button class="btn btn-secondary" onclick="saveResume()">💾 Save</button>
                        <button class="btn btn-secondary" onclick="loadResume()">📂 Load</button>
                    </div>
                </div>
                
                <div class="resume-preview" id="resumePreview">
                    <div class="ats-indicator">ATS Optimized</div>
                    <!-- Resume content will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application state
        let currentTemplate = 'classic';
        let updateTimeout = null;
        let autoSaveInterval = null;
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing SocialWorkU Resume Builder...');
            
            setupEventListeners();
            setupCharacterCounters();
            updateResumePreview();
            updateProgress();
            updateScore();
            startAutoSave();
            showMessage('AI-Enhanced Resume Builder loaded successfully!', 'success');
            
            console.log('Resume Builder initialized successfully');
        });

        // Setup event listeners
        function setupEventListeners() {
            // Template selection
            document.querySelectorAll('.template-option').forEach(function(option) {
                option.addEventListener('click', function() {
                    selectTemplate(this.getAttribute('data-template'));
                });
            });

            // Personal information fields
            const personalFields = ['fullName', 'professionalTitle', 'email', 'phone', 'city', 'linkedin', 'summary'];
            personalFields.forEach(function(id) {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', handleFieldUpdate);
                }
            });

            // Skills fields
            const skillFields = ['clinicalSkills', 'therapeuticSkills', 'populationSkills', 'technicalSkills'];
            skillFields.forEach(function(id) {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', handleFieldUpdate);
                }
            });

            // Dynamic form listeners
            setupDynamicListeners();
        }

        // Setup character counters
        function setupCharacterCounters() {
            const fields = [
                { id: 'summary', max: 500 },
                { id: 'clinicalSkills', max: 300 },
                { id: 'therapeuticSkills', max: 300 },
                { id: 'populationSkills', max: 300 },
                { id: 'technicalSkills', max: 300 }
            ];

            fields.forEach(function(field) {
                const element = document.getElementById(field.id);
                if (element) {
                    addCharacterCounter(element, field.max);
                }
            });

            // Add counters to existing dynamic textareas
            document.querySelectorAll('textarea[maxlength]').forEach(function(textarea) {
                const maxLength = parseInt(textarea.getAttribute('maxlength'));
                addCharacterCounter(textarea, maxLength);
            });
        }

        // Add character counter to field
        function addCharacterCounter(element, maxLength) {
            const counter = element.parentNode.querySelector('.character-count');
            if (counter) {
                const updateCounter = function() {
                    const length = element.value.length;
                    counter.textContent = length + '/' + maxLength;
                    
                    counter.classList.remove('warning', 'error');
                    if (length > maxLength * 0.8) counter.classList.add('warning');
                    if (length > maxLength) counter.classList.add('error');
                };
                
                element.addEventListener('input', updateCounter);
                updateCounter();
            }
        }

        // Handle field updates with debouncing
        function handleFieldUpdate() {
            clearTimeout(updateTimeout);
            updateTimeout = setTimeout(function() {
                updateResumePreview();
                updateProgress();
                updateScore();
            }, 300);
        }

        // Setup dynamic listeners
        function setupDynamicListeners() {
            document.querySelectorAll('[data-type] input, [data-type] textarea, [data-type] select').forEach(function(input) {
                input.removeEventListener('input', handleFieldUpdate);
                input.addEventListener('input', handleFieldUpdate);
            });
        }

        // Select template
        function selectTemplate(templateName) {
            currentTemplate = templateName;
            
            document.querySelectorAll('.template-option').forEach(function(opt) {
                opt.classList.remove('active');
            });
            
            document.querySelector('[data-template="' + templateName + '"]').classList.add('active');
            
            updateResumePreview();
            updateScore();
            
            const atsOptimized = ['classic', 'modern', 'professional'].includes(templateName);
            showMessage(templateName.charAt(0).toUpperCase() + templateName.slice(1) + ' template selected' + (atsOptimized ? ' (ATS Optimized)' : ''), 'success');
        }

        // Start auto-save
        function startAutoSave() {
            autoSaveInterval = setInterval(function() {
                try {
                    const data = collectFormData();
                    if (data.fullName) {
                        const resumeData = {
                            ...data,
                            template: currentTemplate,
                            timestamp: new Date().toISOString()
                        };
                        // Note: In a real application, you would save this to a server
                        // For demo purposes, we're just showing the auto-save indicator
                        showAutoSaveIndicator();
                    }
                } catch (error) {
                    console.error('Auto-save error:', error);
                }
            }, 30000);
        }

        // Show auto-save indicator
        function showAutoSaveIndicator() {
            const indicator = document.getElementById('autosaveIndicator');
            if (indicator) {
                indicator.classList.add('visible');
                setTimeout(function() {
                    indicator.classList.remove('visible');
                }, 2000);
            }
        }

        // Update progress
        function updateProgress() {
            const sections = ['personal', 'summary', 'experience', 'education'];
            let completed = 0;

            sections.forEach(function(section) {
                const isComplete = checkSectionCompletion(section);
                const indicator = document.getElementById(section + 'Complete');
                
                if (indicator) {
                    if (isComplete) {
                        indicator.classList.add('visible');
                        completed++;
                    } else {
                        indicator.classList.remove('visible');
                    }
                }
            });

            const progress = (completed / sections.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update download button
            const downloadBtn = document.getElementById('downloadBtn');
            if (downloadBtn) {
                downloadBtn.disabled = completed < sections.length;
            }
        }

        // Check section completion
        function checkSectionCompletion(section) {
            switch (section) {
                case 'personal':
                    return ['fullName', 'professionalTitle', 'email', 'phone'].every(function(id) {
                        const el = document.getElementById(id);
                        return el && el.value.trim();
                    });
                case 'summary':
                    const summary = document.getElementById('summary');
                    return summary && summary.value.length > 50;
                case 'experience':
                    const exp = document.querySelectorAll('[data-type="experience"]');
                    return Array.from(exp).some(function(item) {
                        const title = item.querySelector('.job-title');
                        const org = item.querySelector('.organization');
                        return title && org && title.value && org.value;
                    });
                case 'education':
                    const edu = document.querySelectorAll('[data-type="education"]');
                    return Array.from(edu).some(function(item) {
                        const degree = item.querySelector('.degree');
                        const inst = item.querySelector('.institution');
                        return degree && inst && degree.value && inst.value;
                    });
                default:
                    return false;
            }
        }

        // Update score
        function updateScore() {
            let score = 0;
            const weights = { personal: 25, summary: 20, experience: 30, education: 15, format: 10 };
            
            if (checkSectionCompletion('personal')) score += weights.personal;
            if (checkSectionCompletion('summary')) score += weights.summary;
            if (checkSectionCompletion('experience')) score += weights.experience;
            if (checkSectionCompletion('education')) score += weights.education;
            
            if (['classic', 'modern', 'professional'].includes(currentTemplate)) {
                score += weights.format;
            }
            
            displayScore(Math.min(score, 100));
        }

        // Display score
        function displayScore(score) {
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreDetails = document.getElementById('scoreDetails');
            
            if (scoreCircle) {
                scoreCircle.textContent = score;
                
                scoreCircle.className = 'score-circle ';
                if (score >= 90) scoreCircle.className += 'score-excellent';
                else if (score >= 75) scoreCircle.className += 'score-good';
                else if (score >= 60) scoreCircle.className += 'score-fair';
                else scoreCircle.className += 'score-poor';
            }
            
            if (scoreDetails) {
                const atsOptimized = ['classic', 'modern', 'professional'].includes(currentTemplate);
                const hasMetrics = /\d+(%|percent|\+|clients|hours)/gi.test(getAllText());
                
                scoreDetails.innerHTML = 
                    '<div class="score-item">ATS: ' + (atsOptimized ? '✓ Optimized' : '⚠ Basic') + '</div>' +
                    '<div class="score-item">Content: ' + (score >= 75 ? 'Strong' : 'Good') + '</div>' +
                    '<div class="score-item">Format: ' + (score >= 60 ? 'Professional' : 'Basic') + '</div>' +
                    '<div class="score-item">Metrics: ' + (hasMetrics ? '✓ Present' : '+ Add Numbers') + '</div>';
            }
        }

        // Get all text for analysis
        function getAllText() {
            const summary = getValue('summary');
            const descriptions = Array.from(document.querySelectorAll('.job-description')).map(function(el) {
                return el.value;
            }).join(' ');
            return summary + ' ' + descriptions;
        }

        // Update resume preview
        function updateResumePreview() {
            const preview = document.getElementById('resumePreview');
            if (!preview) return;

            const data = collectFormData();
            const html = generateResumeHTML(data);
            preview.innerHTML = html;
        }

        // Generate resume HTML with template differences
        function generateResumeHTML(data) {
            let html = '<div class="ats-indicator">ATS Optimized</div>';
            
            // Header - different styles based on template
            if (currentTemplate === 'modern') {
                html += '<div class="resume-header" style="background: linear-gradient(135deg, #163C77 0%, #3CBFBF 100%); color: white; padding: 30px; border-radius: 10px; text-align: center; margin-bottom: 30px;">';
                html += '<div class="resume-name" style="color: white;">' + data.fullName + '</div>';
                html += '<div class="resume-title" style="color: white; opacity: 0.9;">' + data.professionalTitle + '</div>';
                html += '<div class="resume-contact" style="color: white; opacity: 0.8;">';
            } else if (currentTemplate === 'professional') {
                html += '<div class="resume-header" style="border-bottom: 3px double #163C77; padding-bottom: 20px; margin-bottom: 30px;">';
                html += '<div class="resume-name" style="font-size: 28pt; letter-spacing: 1px;">' + data.fullName.toUpperCase() + '</div>';
                html += '<div class="resume-title" style="text-transform: uppercase; letter-spacing: 2px; font-size: 12pt;">' + data.professionalTitle + '</div>';
                html += '<div class="resume-contact">';
            } else {
                html += '<div class="resume-header">';
                html += '<div class="resume-name">' + data.fullName + '</div>';
                html += '<div class="resume-title">' + data.professionalTitle + '</div>';
                html += '<div class="resume-contact">';
            }
            
            const contact = [data.email, data.phone, data.city, data.linkedin].filter(Boolean);
            html += contact.join(' | ');
            html += '</div></div>';
            
            // Helper function for section titles
            function getSectionTitle(title) {
                if (currentTemplate === 'modern') {
                    return '<h3 class="resume-section-title" style="background: #163C77; color: white; padding: 10px 15px; border-radius: 5px; margin-bottom: 15px;">' + title + '</h3>';
                } else if (currentTemplate === 'professional') {
                    return '<h3 class="resume-section-title" style="text-transform: uppercase; letter-spacing: 2px; font-size: 12pt; border-bottom: 2px solid #163C77;">' + title + '</h3>';
                } else if (currentTemplate === 'clinical') {
                    return '<h3 class="resume-section-title" style="background: #f0f9ff; padding: 8px 12px; border-left: 4px solid #3CBFBF; border-bottom: none;">' + title + '</h3>';
                } else {
                    return '<h3 class="resume-section-title">' + title + '</h3>';
                }
            }
            
            // Professional Summary
            if (data.summary) {
                html += '<div class="resume-section">';
                html += getSectionTitle('PROFESSIONAL SUMMARY');
                html += '<p>' + data.summary + '</p>';
                html += '</div>';
            }

            // Experience
            if (data.experience.length > 0) {
                html += '<div class="resume-section">';
                html += getSectionTitle('PROFESSIONAL EXPERIENCE');
                data.experience.forEach(function(exp) {
                    const dateRange = formatDateRange(exp.startDate, exp.endDate);
                    html += '<div class="experience-item">';
                    html += '<div class="item-header">';
                    html += '<div>';
                    html += '<div class="item-title">' + exp.title + '</div>';
                    html += '<div class="item-organization">' + exp.organization + (exp.location ? ', ' + exp.location : '') + '</div>';
                    html += '</div>';
                    html += '<div class="item-date">' + dateRange + '</div>';
                    html += '</div>';
                    if (exp.description) {
                        html += '<div class="item-description">' + formatDescription(exp.description) + '</div>';
                    }
                    html += '</div>';
                });
                html += '</div>';
            }

            // Education
            if (data.education.length > 0) {
                html += '<div class="resume-section">';
                html += getSectionTitle('EDUCATION');
                data.education.forEach(function(edu) {
                    html += '<div class="experience-item">';
                    html += '<div class="item-header">';
                    html += '<div>';
                    html += '<div class="item-title">' + edu.degree + '</div>';
                    html += '<div class="item-organization">' + edu.institution + '</div>';
                    html += '</div>';
                    html += '<div class="item-date">' + edu.gradYear + '</div>';
                    html += '</div>';
                    if (edu.details) {
                        html += '<div class="item-description">' + formatDescription(edu.details) + '</div>';
                    }
                    html += '</div>';
                });
                html += '</div>';
            }

            // Skills
            const hasSkills = data.skills.clinical || data.skills.therapeutic || data.skills.population || data.skills.technical;
            if (hasSkills) {
                html += '<div class="resume-section">';
                html += getSectionTitle('SKILLS & COMPETENCIES');
                
                if (currentTemplate === 'modern') {
                    html += '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">';
                    if (data.skills.clinical) {
                        html += '<div style="background: #f8fafc; padding: 12px; border-radius: 6px; border-left: 4px solid #3CBFBF;">';
                        html += '<strong style="color: #163C77;">Clinical Skills:</strong><br>' + data.skills.clinical + '</div>';
                    }
                    if (data.skills.therapeutic) {
                        html += '<div style="background: #f8fafc; padding: 12px; border-radius: 6px; border-left: 4px solid #3CBFBF;">';
                        html += '<strong style="color: #163C77;">Therapeutic Approaches:</strong><br>' + data.skills.therapeutic + '</div>';
                    }
                    if (data.skills.population) {
                        html += '<div style="background: #f8fafc; padding: 12px; border-radius: 6px; border-left: 4px solid #3CBFBF;">';
                        html += '<strong style="color: #163C77;">Populations Served:</strong><br>' + data.skills.population + '</div>';
                    }
                    if (data.skills.technical) {
                        html += '<div style="background: #f8fafc; padding: 12px; border-radius: 6px; border-left: 4px solid #3CBFBF;">';
                        html += '<strong style="color: #163C77;">Technical Skills:</strong><br>' + data.skills.technical + '</div>';
                    }
                    html += '</div>';
                } else {
                    if (data.skills.clinical) html += '<p><strong>Clinical Skills:</strong> ' + data.skills.clinical + '</p>';
                    if (data.skills.therapeutic) html += '<p><strong>Therapeutic Approaches:</strong> ' + data.skills.therapeutic + '</p>';
                    if (data.skills.population) html += '<p><strong>Populations Served:</strong> ' + data.skills.population + '</p>';
                    if (data.skills.technical) html += '<p><strong>Technical Skills:</strong> ' + data.skills.technical + '</p>';
                }
                html += '</div>';
            }
            
            return html;
        }

        // Collect form data
        function collectFormData() {
            return {
                fullName: getValue('fullName') || 'Your Name Here',
                professionalTitle: getValue('professionalTitle') || 'Social Work Professional',
                email: getValue('email') || 'email@example.com',
                phone: getValue('phone') || '(555) 123-4567',
                city: getValue('city') || 'City, State',
                linkedin: getValue('linkedin'),
                summary: getValue('summary'),
                experience: collectDynamicData('experience'),
                education: collectDynamicData('education'),
                skills: {
                    clinical: getValue('clinicalSkills'),
                    therapeutic: getValue('therapeuticSkills'),
                    population: getValue('populationSkills'),
                    technical: getValue('technicalSkills')
                }
            };
        }

        // Get field value safely
        function getValue(id) {
            const element = document.getElementById(id);
            return element ? element.value.trim() : '';
        }

        // Collect dynamic data
        function collectDynamicData(type) {
            const items = [];
            document.querySelectorAll('[data-type="' + type + '"]').forEach(function(item) {
                const data = {};
                
                if (type === 'experience') {
                    data.title = item.querySelector('.job-title') ? item.querySelector('.job-title').value : '';
                    data.organization = item.querySelector('.organization') ? item.querySelector('.organization').value : '';
                    data.location = item.querySelector('.job-location') ? item.querySelector('.job-location').value : '';
                    data.startDate = item.querySelector('.start-date') ? item.querySelector('.start-date').value : '';
                    data.endDate = item.querySelector('.end-date') ? item.querySelector('.end-date').value : '';
                    data.description = item.querySelector('.job-description') ? item.querySelector('.job-description').value : '';
                } else if (type === 'education') {
                    data.degree = item.querySelector('.degree') ? item.querySelector('.degree').value : '';
                    data.institution = item.querySelector('.institution') ? item.querySelector('.institution').value : '';
                    data.gradYear = item.querySelector('.grad-year') ? item.querySelector('.grad-year').value : '';
                    data.details = item.querySelector('.education-details') ? item.querySelector('.education-details').value : '';
                }
                
                if (Object.values(data).some(function(value) { return value; })) {
                    items.push(data);
                }
            });
            
            return items;
        }

        // Format description
        function formatDescription(text) {
            if (!text) return '';
            
            const lines = text.split('\n').map(function(line) {
                return line.trim();
            }).filter(function(line) {
                return line;
            });
            
            if (lines.length === 1) {
                return '<p>' + lines[0] + '</p>';
            }
            
            const listItems = lines.map(function(line) {
                const cleanLine = line.replace(/^[•·\-\*]\s*/, '');
                return '<li>' + cleanLine + '</li>';
            }).join('');
            
            return '<ul>' + listItems + '</ul>';
        }

        // Format date range
        function formatDateRange(startDate, endDate) {
            if (!startDate) return 'Dates';
            
            const start = formatMonth(startDate);
            const end = endDate ? formatMonth(endDate) : 'Present';
            
            return start + ' - ' + end;
        }

        // Format month
        function formatMonth(monthString) {
            if (!monthString) return '';
            
            try {
                const date = new Date(monthString + '-01');
                return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
            } catch (e) {
                return monthString;
            }
        }

        // Show message
        function showMessage(message, type) {
            const container = document.getElementById('messageContainer');
            const messageEl = document.createElement('div');
            messageEl.className = 'message ' + type + ' show';
            messageEl.textContent = message;
            
            container.appendChild(messageEl);
            
            setTimeout(function() {
                if (messageEl.parentNode) {
                    messageEl.remove();
                }
            }, 4000);
        }

        // AI Generation Functions
        function generateAISummary() {
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⏳ Generating...';
            btn.disabled = true;

            setTimeout(function() {
                const suggestions = [
                    'Compassionate Licensed Clinical Social Worker with 7+ years of experience providing evidence-based therapy to diverse populations in community mental health settings. Expertise in trauma-informed care, crisis intervention, and collaborative treatment planning with demonstrated 30% improvement in client outcomes.',
                    
                    'Results-driven School Social Worker with 5+ years of experience supporting student success through comprehensive mental health services and behavioral interventions. Skilled in crisis response and family engagement with 95% parent satisfaction rating.',
                    
                    'Experienced Healthcare Social Worker specializing in discharge planning and patient advocacy with 6+ years in acute care settings. Proven ability to reduce average length of stay by 20% through effective care coordination.'
                ];

                showAISuggestions('summarySuggestions', 'summaryOptions', suggestions, 'summary');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 2000);
        }

        function generateJobDescription(button) {
            const experienceItem = button.closest('.dynamic-item');
            const jobTitle = experienceItem.querySelector('.job-title').value;
            
            if (!jobTitle) {
                showMessage('Please enter a job title first', 'warning');
                return;
            }

            button.innerHTML = '⏳ Enhancing...';
            button.disabled = true;

            setTimeout(function() {
                const suggestions = [
                    '• Provided individual and group therapy to 25+ clients weekly using evidence-based approaches including CBT, DBT, and trauma-informed care\n• Achieved 95% client satisfaction rating and 30% improvement in treatment outcomes through innovative intervention strategies\n• Collaborated with multidisciplinary teams to develop comprehensive treatment plans for complex cases\n• Maintained detailed documentation and case records in compliance with HIPAA and state regulations',

                    '• Conducted comprehensive psychosocial assessments and developed individualized treatment plans for diverse client populations\n• Facilitated weekly support groups for clients with substance use disorders, achieving 80% completion rate\n• Provided crisis intervention and safety planning for high-risk clients, reducing emergency interventions by 40%\n• Supervised MSW interns and participated in quality improvement initiatives'
                ];

                const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                experienceItem.querySelector('.job-description').value = randomSuggestion;
                
                button.innerHTML = '✨ AI Enhance';
                button.disabled = false;
                handleFieldUpdate();
            }, 2000);
        }

        function generateAISkills() {
            const btn = event.target;
            btn.innerHTML = '⏳ Analyzing...';
            btn.disabled = true;

            setTimeout(function() {
                document.getElementById('clinicalSkills').value = 'Individual Therapy, Group Therapy, Crisis Intervention, Risk Assessment, Treatment Planning, Case Management';
                document.getElementById('therapeuticSkills').value = 'Cognitive Behavioral Therapy (CBT), Dialectical Behavior Therapy (DBT), Trauma-Informed Care, Motivational Interviewing';
                document.getElementById('populationSkills').value = 'Adults, Children & Adolescents, Families, Veterans, LGBTQ+ Community, Trauma Survivors';
                document.getElementById('technicalSkills').value = 'Electronic Health Records (EHR), Case Management Software, Microsoft Office, Telehealth Platforms';

                btn.innerHTML = '✨ AI Suggest';
                btn.disabled = false;
                handleFieldUpdate();
                showMessage('AI-generated skills based on your experience!', 'success');
            }, 1500);
        }

        function showAISuggestions(containerId, optionsId, suggestions, targetFieldId) {
            const container = document.getElementById(containerId);
            const optionsContainer = document.getElementById(optionsId);
            
            optionsContainer.innerHTML = '';
            suggestions.forEach(function(suggestion) {
                const option = document.createElement('div');
                option.className = 'suggestion-item';
                option.textContent = suggestion;
                option.onclick = function() {
                    document.getElementById(targetFieldId).value = suggestion;
                    container.classList.remove('visible');
                    handleFieldUpdate();
                };
                optionsContainer.appendChild(option);
            });
            
            container.classList.add('visible');
        }

        // Template functions
        function loadSummaryTemplate() {
            const templates = [
                'Dedicated social work professional with expertise in clinical practice and community engagement. Committed to empowering individuals and families through evidence-based interventions and culturally responsive care.',
                
                'Licensed Social Worker with specialized experience in mental health services and case management. Strong background in crisis intervention and collaborative treatment planning with diverse populations.',
                
                'Experienced Social Worker focused on advocacy and direct practice with vulnerable populations. Skilled in assessment, treatment planning, and resource coordination with proven outcomes.'
            ];
            
            const randomTemplate = templates[Math.floor(Math.random() * templates.length)];
            document.getElementById('summary').value = randomTemplate;
            handleFieldUpdate();
            showMessage('Template loaded successfully', 'success');
        }

        function loadSkillsTemplate() {
            document.getElementById('clinicalSkills').value = 'Individual Therapy, Group Therapy, Crisis Intervention, Risk Assessment, Treatment Planning, Case Management, Documentation';
            document.getElementById('therapeuticSkills').value = 'Cognitive Behavioral Therapy (CBT), Dialectical Behavior Therapy (DBT), Trauma-Informed Care, Motivational Interviewing, Solution-Focused Therapy';
            document.getElementById('populationSkills').value = 'Adults, Children & Adolescents, Families, Veterans, LGBTQ+ Community, Trauma Survivors, Individuals with Mental Health Disorders';
            document.getElementById('technicalSkills').value = 'Electronic Health Records (EHR), Case Management Software, Microsoft Office Suite, SPSS, Telehealth Platforms, Crisis Management Systems';
            
            handleFieldUpdate();
            showMessage('Social work skills template loaded', 'success');
        }

        function clearField(fieldId) {
            if (confirm('Clear this field?')) {
                document.getElementById(fieldId).value = '';
                handleFieldUpdate();
                showMessage('Field cleared', 'success');
            }
        }

        function clearSkills() {
            if (confirm('Clear all skills?')) {
                ['clinicalSkills', 'therapeuticSkills', 'populationSkills', 'technicalSkills'].forEach(function(id) {
                    document.getElementById(id).value = '';
                });
                handleFieldUpdate();
                showMessage('Skills cleared', 'success');
            }
        }

        // Dynamic item functions
        function addExperience() {
            const container = document.getElementById('experienceContainer');
            const template = document.createElement('div');
            template.className = 'dynamic-item';
            template.dataset.type = 'experience';
            template.innerHTML = 
                '<button class="remove-item" onclick="removeItem(this)">×</button>' +
                '<div class="btn-group" style="margin-bottom: 15px;">' +
                    '<button class="btn btn-ai btn-small" onclick="generateJobDescription(this)">✨ AI Enhance</button>' +
                '</div>' +
                '<div class="form-group">' +
                    '<label>Job Title</label>' +
                    '<input type="text" placeholder="Social Worker" class="job-title">' +
                '</div>' +
                '<div class="form-row">' +
                    '<div class="form-group">' +
                        '<label>Organization</label>' +
                        '<input type="text" placeholder="Community Health Center" class="organization">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label>Location</label>' +
                        '<input type="text" placeholder="Austin, TX" class="job-location">' +
                    '</div>' +
                '</div>' +
                '<div class="form-row">' +
                    '<div class="form-group">' +
                        '<label>Start Date</label>' +
                        '<input type="month" class="start-date">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label>End Date (current job: leave blank)</label>' +
                        '<input type="month" class="end-date">' +
                    '</div>' +
                '</div>' +
                '<div class="form-group">' +
                    '<label>Job Description</label>' +
                    '<textarea rows="4" placeholder="• Describe your key responsibilities and achievements" class="job-description" maxlength="1000"></textarea>' +
                    '<div class="character-count">0/1000</div>' +
                '</div>';
            
            container.appendChild(template);
            updateExperienceRemoveButtons();
            
            const textarea = template.querySelector('.job-description');
            addCharacterCounter(textarea, 1000);
            
            setupDynamicListeners();
            handleFieldUpdate();
            showMessage('Experience section added', 'success');
        }

        function addEducation() {
            const container = document.getElementById('educationContainer');
            const template = document.createElement('div');
            template.className = 'dynamic-item';
            template.dataset.type = 'education';
            template.innerHTML = 
                '<button class="remove-item" onclick="removeItem(this)">×</button>' +
                '<div class="form-group">' +
                    '<label>Degree</label>' +
                    '<select class="degree">' +
                        '<option value="">Select Degree</option>' +
                        '<option value="MSW">Master of Social Work (MSW)</option>' +
                        '<option value="BSW">Bachelor of Social Work (BSW)</option>' +
                        '<option value="PhD in Social Work">PhD in Social Work</option>' +
                        '<option value="DSW">Doctor of Social Work (DSW)</option>' +
                    '</select>' +
                '</div>' +
                '<div class="form-row">' +
                    '<div class="form-group">' +
                        '<label>Institution</label>' +
                        '<input type="text" placeholder="State University" class="institution">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label>Graduation Year</label>' +
                        '<input type="number" placeholder="2020" class="grad-year" min="1950" max="2030">' +
                    '</div>' +
                '</div>' +
                '<div class="form-group">' +
                    '<label>Additional Details</label>' +
                    '<textarea rows="2" placeholder="GPA, honors, relevant coursework" class="education-details" maxlength="300"></textarea>' +
                    '<div class="character-count">0/300</div>' +
                '</div>';
            
            container.appendChild(template);
            updateEducationRemoveButtons();
            
            const textarea = template.querySelector('.education-details');
            addCharacterCounter(textarea, 300);
            
            setupDynamicListeners();
            handleFieldUpdate();
            showMessage('Education section added', 'success');
        }

        function removeItem(button) {
            if (confirm('Remove this item?')) {
                const item = button.closest('.dynamic-item');
                const container = item.parentNode;
                
                item.remove();
                
                if (container.id === 'experienceContainer') {
                    updateExperienceRemoveButtons();
                } else if (container.id === 'educationContainer') {
                    updateEducationRemoveButtons();
                }
                
                handleFieldUpdate();
                showMessage('Item removed', 'success');
            }
        }

        function updateExperienceRemoveButtons() {
            const items = document.querySelectorAll('#experienceContainer .dynamic-item');
            items.forEach(function(item, index) {
                const removeBtn = item.querySelector('.remove-item');
                if (removeBtn) {
                    removeBtn.style.display = items.length > 1 ? 'flex' : 'none';
                }
            });
        }

        function updateEducationRemoveButtons() {
            const items = document.querySelectorAll('#educationContainer .dynamic-item');
            items.forEach(function(item, index) {
                const removeBtn = item.querySelector('.remove-item');
                if (removeBtn) {
                    removeBtn.style.display = items.length > 1 ? 'flex' : 'none';
                }
            });
        }

        // Control functions
        function downloadResume() {
            showMessage('Download functionality would integrate with a PDF generation service', 'info');
        }

        function printResume() {
            window.print();
        }

        function saveResume() {
            const data = collectFormData();
            const resumeData = {
                ...data,
                template: currentTemplate,
                timestamp: new Date().toISOString()
            };
            
            // Create a download link for the JSON data
            const dataStr = JSON.stringify(resumeData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'resume-data.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showMessage('Resume data saved successfully!', 'success');
        }

        function loadResume() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            loadResumeData(data);
                            showMessage('Resume loaded successfully!', 'success');
                        } catch (error) {
                            showMessage('Error loading resume file', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }

        function loadResumeData(data) {
            // Load basic fields
            document.getElementById('fullName').value = data.fullName || '';
            document.getElementById('professionalTitle').value = data.professionalTitle || '';
            document.getElementById('email').value = data.email || '';
            document.getElementById('phone').value = data.phone || '';
            document.getElementById('city').value = data.city || '';
            document.getElementById('linkedin').value = data.linkedin || '';
            document.getElementById('summary').value = data.summary || '';
            
            // Load skills
            document.getElementById('clinicalSkills').value = data.skills?.clinical || '';
            document.getElementById('therapeuticSkills').value = data.skills?.therapeutic || '';
            document.getElementById('populationSkills').value = data.skills?.population || '';
            document.getElementById('technicalSkills').value = data.skills?.technical || '';
            
            // Set template
            if (data.template) {
                selectTemplate(data.template);
            }
            
            handleFieldUpdate();
        }

        function showDetailedAnalysis() {
            createAnalysisModal();
        }

        function createAnalysisModal() {
            // Remove existing modal if present
            const existingModal = document.getElementById('analysisModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Create modal overlay
            const modal = document.createElement('div');
            modal.id = 'analysisModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                border-radius: 12px;
                width: 90%;
                max-width: 800px;
                max-height: 90vh;
                overflow-y: auto;
                position: relative;
                animation: slideIn 0.3s ease;
            `;

            modalContent.innerHTML = generateAnalysisContent();
            modal.appendChild(modalContent);
            document.body.appendChild(modal);

            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function generateAnalysisContent() {
            const data = collectFormData();
            const score = parseInt(document.getElementById('scoreCircle').textContent);
            const allText = getAllText();
            const hasMetrics = /\d+(%|percent|\+|clients|hours|years)/gi.test(allText);
            const isATSOptimized = ['classic', 'modern', 'professional'].includes(currentTemplate);
            
            // Analyze sections
            const personalComplete = checkSectionCompletion('personal');
            const summaryComplete = checkSectionCompletion('summary');
            const experienceComplete = checkSectionCompletion('experience');
            const educationComplete = checkSectionCompletion('education');
            
            // Count achievements and action verbs
            const actionVerbs = (allText.match(/\b(provided|managed|developed|implemented|achieved|led|coordinated|facilitated|assessed|supervised|collaborated|improved|reduced|increased)\b/gi) || []).length;
            const wordCount = allText.split(' ').length;
            
            return `
                <div style="padding: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #e2e8f0; padding-bottom: 15px;">
                        <h2 style="color: #163C77; margin: 0; font-size: 1.5rem;">Detailed Resume Analysis</h2>
                        <button onclick="document.getElementById('analysisModal').remove()" style="background: #ef4444; color: white; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; font-size: 1.2rem;">×</button>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 12px;">
                            <div style="font-size: 2.5rem; font-weight: bold; color: #163C77; margin-bottom: 5px;">${score}</div>
                            <div style="font-size: 1.1rem; color: #666;">Overall Score</div>
                        </div>
                        <div style="padding: 20px;">
                            <h3 style="color: #163C77; margin-bottom: 15px; font-size: 1.1rem;">Score Breakdown</h3>
                            <div style="margin-bottom: 8px;">Personal Info: <span style="color: ${personalComplete ? '#10b981' : '#ef4444'};">${personalComplete ? '✓ Complete' : '⚠ Missing'}</span></div>
                            <div style="margin-bottom: 8px;">Summary: <span style="color: ${summaryComplete ? '#10b981' : '#ef4444'};">${summaryComplete ? '✓ Complete' : '⚠ Missing'}</span></div>
                            <div style="margin-bottom: 8px;">Experience: <span style="color: ${experienceComplete ? '#10b981' : '#ef4444'};">${experienceComplete ? '✓ Complete' : '⚠ Missing'}</span></div>
                            <div>Education: <span style="color: ${educationComplete ? '#10b981' : '#ef4444'};">${educationComplete ? '✓ Complete' : '⚠ Missing'}</span></div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                        <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #3CBFBF;">
                            <h3 style="color: #163C77; margin-bottom: 15px; font-size: 1.1rem;">ATS Optimization</h3>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Template</span>
                                    <span style="color: ${isATSOptimized ? '#10b981' : '#f59e0b'};">${isATSOptimized ? 'ATS-Friendly' : 'Basic'}</span>
                                </div>
                                <div style="background: #e2e8f0; height: 6px; border-radius: 3px;">
                                    <div style="background: ${isATSOptimized ? '#10b981' : '#f59e0b'}; height: 100%; width: ${isATSOptimized ? '90%' : '60%'}; border-radius: 3px;"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Keywords</span>
                                    <span style="color: ${actionVerbs >= 8 ? '#10b981' : '#f59e0b'};">${actionVerbs >= 8 ? 'Strong' : 'Needs More'}</span>
                                </div>
                                <div style="background: #e2e8f0; height: 6px; border-radius: 3px;">
                                    <div style="background: ${actionVerbs >= 8 ? '#10b981' : '#f59e0b'}; height: 100%; width: ${Math.min((actionVerbs / 12) * 100, 100)}%; border-radius: 3px;"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Metrics</span>
                                    <span style="color: ${hasMetrics ? '#10b981' : '#ef4444'};">${hasMetrics ? 'Present' : 'Missing'}</span>
                                </div>
                                <div style="background: #e2e8f0; height: 6px; border-radius: 3px;">
                                    <div style="background: ${hasMetrics ? '#10b981' : '#ef4444'}; height: 100%; width: ${hasMetrics ? '85%' : '20%'}; border-radius: 3px;"></div>
                                </div>
                            </div>
                        </div>

                        <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #8b5cf6;">
                            <h3 style="color: #163C77; margin-bottom: 15px; font-size: 1.1rem;">Content Analysis</h3>
                            <div style="margin-bottom: 12px;">
                                <strong>Word Count:</strong> ${wordCount} ${wordCount < 200 ? '(Too short)' : wordCount > 600 ? '(Too long)' : '(Good)'}
                            </div>
                            <div style="margin-bottom: 12px;">
                                <strong>Action Verbs:</strong> ${actionVerbs} found
                            </div>
                            <div style="margin-bottom: 12px;">
                                <strong>Quantified Results:</strong> ${hasMetrics ? 'Yes' : 'No'}
                            </div>
                            <div>
                                <strong>Industry Terms:</strong> ${(allText.match(/\b(therapy|clinical|assessment|intervention|treatment|counseling|case management)\b/gi) || []).length} detected
                            </div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 20px; border-radius: 12px; margin-bottom: 25px;">
                        <h3 style="color: #92400e; margin-bottom: 15px; font-size: 1.1rem;">Priority Recommendations</h3>
                        <div style="display: grid; gap: 10px;">
                            ${!personalComplete ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #ef4444;">🔴 Complete personal information section</div>' : ''}
                            ${!summaryComplete ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #ef4444;">🔴 Write a professional summary (minimum 50 characters)</div>' : ''}
                            ${!hasMetrics ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #f59e0b;">🟡 Add quantifiable achievements (numbers, percentages, outcomes)</div>' : ''}
                            ${actionVerbs < 8 ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #f59e0b;">🟡 Use more action verbs (managed, developed, implemented)</div>' : ''}
                            ${!isATSOptimized ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #3b82f6;">🔵 Consider switching to an ATS-optimized template</div>' : ''}
                            ${wordCount < 200 ? '<div style="padding: 8px 12px; background: white; border-radius: 6px; border-left: 4px solid #3b82f6;">🔵 Expand content - add more detail to experience descriptions</div>' : ''}
                        </div>
                    </div>

                    <div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">
                        <h3 style="color: #163C77; margin-bottom: 15px; font-size: 1.1rem;">Social Work Industry Tips</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <h4 style="color: #3CBFBF; margin-bottom: 8px; font-size: 0.95rem;">Essential Keywords</h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem;">
                                    <li>Evidence-based practice</li>
                                    <li>Trauma-informed care</li>
                                    <li>Crisis intervention</li>
                                    <li>Case management</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #3CBFBF; margin-bottom: 8px; font-size: 0.95rem;">Quantify Impact</h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem;">
                                    <li>Client caseload size</li>
                                    <li>Success rates</li>
                                    <li>Program outcomes</li>
                                    <li>Time reductions</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 25px;">
                        <button onclick="document.getElementById('analysisModal').remove()" style="background: #163C77; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 1rem; cursor: pointer;">Close Analysis</button>
                    </div>
                </div>
            `;
        }

        // Initialize character counters on page load
        setTimeout(function() {
            setupCharacterCounters();
            setupDynamicListeners();
        }, 100);
    </script>
</body>
</html>
